<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>REGISTER FORM</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <style media="screen">
      #id_first_name, #id_last_name{
        width:48.1%;
        float:left;

      }label{
        display:none;
      }
      #id_first_name, #id_last_name, #id_username, #id_password,#id_contact{

        margin: 10px 4px 10px 4px;
      }
      #id_last_name0{
        margin-left:10px;
      }
      .form-group > small{
        color:white !important;
      }
    </style>
    <script>
      var p = '';
      $(function(){
        $('#sotp').click(function(){
          var number = $('#id_contact').val();
          if(number.length != 10){
            alert("You entered incorrect number");
          }
          else{
            $.ajax({
              url:'{% url "generate"%}',
              data:{'number':number},
              success:function(data){
                p=data;
                if(p!=0){
                  $('#msg').html('OTP Sent!!! ');
                  $('#votp').css({'display':'block'});
                  $('#vrotp').css({'display':'block'});
                  $('#sotp').css({'display':'none'});
                }else{
                  $('#msg').html( 'something went wrong');
                } 
              }
            });
          }
        });
        $('#vrotp').click(function(){
          var d = $('#votp').val();
          $.ajax({
            url:'{% url "validate"%}',
            data:{'number':d,'p':p},
            success:function(data){
              if(data===1){
                $('#msg').html('OTP verification Success!!! ');
              }else{
                $('#msg').html('OTP verification Failed!!! ');
              }
              
            }
          });
        });
      });
    </script>
  </head>
  <body>
    <div class="container-fluid bg-light">
      <div class="row py-5">
        <div class="col-md-6 p-5 mx-auto bg-danger text-white">
          <h2>Register Here</h2>
          <form class="" method="post">
            {% csrf_token %}
            {{ form.as_p }}
            {{ form1.as_p }}
            <input type="button" class='btn btn-success btn-block my-2'  name="" value="Send OTP" id='sotp'>
            <input type="text" class='form-control' style='display:none;' placeholder="Enter OTP" id='votp'>
            <input type="button" class='btn btn-warning btn-block my-2' style='display:none;'  name="" value="verify OTP" id='vrotp'>
            <small class='text-success' id='msg'></small>
            <input type="submit" id='sb' name="register" class='btn btn-success btn-block' value="Register">
          </form>
        </div>
      </div>
    </div>
  </body>
</html>